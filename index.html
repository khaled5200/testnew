<!DOCTYPE html>
<html>
<head>
    <title>Submit Form</title>
</head>
<body>
    <h2>Submit Your Information</h2>
    <form id="myForm">
        <label for="date">Date (dd/mm/yyyy):</label><br>
        <input type="text" id="date" name="date" placeholder="dd/mm/yyyy" maxlength="10" oninput="formatDate(this)"><br><br>
        
        <label for="name">Name:</label><br>
        <input type="text" id="name" name="name" list="nameList" placeholder="Search name..." required><br><br>
        <datalist id="nameList">
            <option value="Ahmed saad">
            <option value="saad saeed">
        </datalist><br><br>
        
        <label for="vehicleNumber">Vehicle Number:</label><br>
        <input type="number" id="vehicleNumber" name="vehicleNumber" min="1" max="7" required><br><br>
        
        <label for="route">Route (Letter + Number):</label><br>
        <input type="text" id="route" name="route" pattern="[A-Za-z][0-9]" required><br><br>
        
        <label for="cash">Cash:</label><br>
        <input type="number" id="cash" name="cash" required><br><br>
        
        <label for="receivedShipments">Received Shipments:</label><br>
        <input type="number" id="receivedShipments" name="receivedShipments" required><br><br>
        
        <label for="deliveredShipments">Delivered Shipments:</label><br>
        <input type="number" id="deliveredShipments" name="deliveredShipments" required><br><br>
        
        <label for="returnedShipments">Returned Shipments:</label><br>
        <input type="text" id="returnedShipments" name="returnedShipments" readonly><br><br>
        
        <label for="lostShipments">Lost Shipments:</label><br>
        <input type="number" id="lostShipments" name="lostShipments" required><br><br>
        
        <label for="reason">Reason (Max 50 characters per line, 5 lines):</label><br>
        <textarea id="reason" name="reason" rows="5" maxlength="50" required></textarea><br><br>
        
        <input type="submit" value="Submit">
    </form>
    
    <script>
        // Format Date input to dd/mm/yyyy with automatic "/"
        function formatDate(input) {
            let value = input.value.replace(/[^0-9]/g, '').slice(0, 8); // Allow only numbers and limit to 8 digits
            if (value.length > 2) value = value.slice(0, 2) + '/' + value.slice(2);
            if (value.length > 5) value = value.slice(0, 5) + '/' + value.slice(5, 10);
            input.value = value;
        }
        
        // Calculate returned shipments automatically
        document.getElementById('myForm').onsubmit = function(event) {
            event.preventDefault();
            
            const received = document.getElementById('receivedShipments').value;
            const delivered = document.getElementById('deliveredShipments').value;
            
            // Calculate returned shipments
            const returned = received - delivered;
            document.getElementById('returnedShipments').value = returned;

            const formData = new FormData();
            formData.append('date', document.getElementById('date').value);
            formData.append('name', document.getElementById('name').value);
            formData.append('vehicleNumber', document.getElementById('vehicleNumber').value);
            formData.append('route', document.getElementById('route').value);
            formData.append('cash', document.getElementById('cash').value);
            formData.append('receivedShipments', received);
            formData.append('deliveredShipments', delivered);
            formData.append('returnedShipments', returned);
            formData.append('lostShipments', document.getElementById('lostShipments').value);
            formData.append('reason', document.getElementById('reason').value);

            fetch('https://script.google.com/macros/s/AKfycbzc1EdbkvTHQKNMEILgYSBrdjj9klaeMiqSL_RzItBosiV3ocJFcV8bBEm8Yn1u3cbn6w/exec', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Data submitted successfully!');
                } else {
                    alert('Error submitting data: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error submitting data!');
            });
        }
    </script>
</body>
</html>
